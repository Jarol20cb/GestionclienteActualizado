<div class="main-container">
  <div class="content">
    <div class="header" style="display: flex;">
      <h1>Bienvenido, {{user.name}}! 
        <img style="width: 50px; height: 50px;" *ngIf="user.accountType === 'PREMIUM'" src="assets/premium.png" alt="Premium" class="small-image">
        <img style="width: 50px; height: 50px;" *ngIf="user.accountType === 'FREE'" src="assets/free.png" alt="Free" class="small-image">
      </h1>     
    </div>

    <div class="bottom-section">
      <div class="dashboard-grid">
    
        <div class="report-card" routerLink="/components/customer-overview">
          <div class="report-header" style="display: block; cursor: pointer;">
            <img src="assets/iconos/cliente.png" alt="Clientes" class="report-image">
            <h3>Clientes</h3>
          </div>
        </div>
    
        <div class="report-card" routerLink="/components/servicios-overview">
          <div class="report-header" style="display: block; cursor: pointer;">
            <img src="assets/iconos/netflix.png" alt="Servicios" class="report-image">
            <h3>Servicios</h3>
          </div>
        </div>
    
        <div class="report-card" routerLink="/components/perfil-overview">
          <div class="report-header" style="display: block; cursor: pointer;">
            <img src="assets/iconos/perfiles.png" alt="Perfiles" class="report-image">
            <h3>Perfiles</h3>
          </div>
        </div>
    
        <div class="report-card" routerLink="/components/socioproveedor-overview">
          <div class="report-header" style="display: block; cursor: pointer;">
            <img src="assets/iconos/trabajando.png" alt="Socios y Proveedores" class="report-image">
            <h3>Socios y Proveedores</h3>
          </div>
        </div>
      </div>
    </div>
    <br>

    <div class="dashboard">
      <div class="top-section">
    
        <div class="widgets-section">
          <h1 style="font-weight: 700; color: #34495e; text-align: center;">Plataformas con más perfiles</h1>
          
          <!-- Contenido que se cubrirá si no es PREMIUM -->
          <div class="content-to-cover">
            <canvas *ngIf="popularPlatforms.length > 0" id="popularPlatformsChart" width="430" height="250"></canvas>
            <div *ngIf="popularPlatforms.length === 0">
              <img src="assets/koala-durmiendo.png" alt="No hay clientes con estado pendiente" style="max-width: 40%; height: auto; display: block; margin: 0 auto;">
              <p>Aún no hay datos para mostrar.</p>
            </div>
        
            <!-- Imagen que cubre todo si el usuario no es PREMIUM -->
            <div *ngIf="user.accountType !== 'PREMIUM'" class="overlay" (click)="onButtonClick()" style="cursor: pointer;">
              <img src="assets/premium.png" alt="Contenido exclusivo para usuarios Premium" class="overlay-image">
            </div>
          </div>
        </div>
        
        
        <div class="clients-section">
          <h1 style="font-weight: 700;">Clientes con Estado Pendiente</h1><br>
          <div class="report-card accordion-card" *ngIf="paginatedClientes.length > 0">
              <mat-accordion>
                  <mat-expansion-panel *ngFor="let cliente of paginatedClientes">
                      <mat-expansion-panel-header>
                          <mat-panel-title>
                              {{ cliente.name }} - Deudor
                          </mat-panel-title>
                      </mat-expansion-panel-header>
                      <div>
                          <p><strong>Fecha de Inicio:</strong> {{ cliente.fechainicio | date: 'dd/MM/yyyy' }}</p>
                          <p><strong>Fecha de Pago:</strong> {{ cliente.fechafin | date: 'dd/MM/yyyy' }}</p>
                          <p><strong>Tipo de Servicio:</strong> {{ cliente.services.service }}</p>
                      </div>
                      <!-- Botón de Ver -->
                      <button class="ver-button" (click)="verCliente(cliente.idcs)">
                          Ver
                      </button>
                  </mat-expansion-panel>
              </mat-accordion>
              <div *ngIf="clientesPendientes.length > itemsPerPage" class="pagination-controls">
                  <button (click)="previousPage()" [disabled]="currentPage === 1">
                      <span class="material-icons">chevron_left</span>
                  </button>
                  <span>Página {{ currentPage }}</span>
                  <button (click)="nextPage()" [disabled]="currentPage * itemsPerPage >= clientesPendientes.length">
                      <span class="material-icons">chevron_right</span>
                  </button>
              </div>
          </div>
          <div *ngIf="clientesPendientes.length === 0" class="no-clientes">
              <img src="assets/koala-durmiendo.png" alt="No hay clientes con estado pendiente" style="max-width: 40%; height: auto; display: block; margin: 0 auto;">
              <p>Tus clientes estan al día.</p>
          </div>
      </div>
       
      </div>

      <div class="bottom-section">
        <div class="dashboard-grid">
          <div class="report-card">
            <div class="report-header">
              <span class="material-icons report-icon">group</span>
              <h2>{{ totalUsuarios }}</h2>
            </div>
            <p>Total de usuarios</p>
      
            <!-- Overlay para cuentas no Premium -->
            <div *ngIf="user.accountType !== 'PREMIUM'" class="overlay" (click)="onButtonClick()" style="cursor: pointer;">
              <img src="assets/premium.png" alt="Contenido exclusivo para usuarios Premium" class="overlay-image">
            </div>
          </div>
      
          <div class="report-card">
            <div class="report-header">
              <span class="material-icons report-icon">account_balance_wallet</span>
              <h2>{{ usuariosDeudores }}</h2>
            </div>
            <p>Usuarios deudores</p>
      
            <!-- Overlay para cuentas no Premium -->
            <div *ngIf="user.accountType !== 'PREMIUM'" class="overlay" (click)="onButtonClick()" style="cursor: pointer;">
              <img src="assets/premium.png" alt="Contenido exclusivo para usuarios Premium" class="overlay-image">
            </div>
          </div>
      
          <div class="report-card">
            <div class="report-header">
              <span class="material-icons report-icon">badge</span>
              <h2>{{ usuariosDisponiblesPerfiles }}</h2>
            </div>
            <p>Total de Perfiles Disponibles</p>
      
            <!-- Overlay para cuentas no Premium -->
            <div *ngIf="user.accountType !== 'PREMIUM'" class="overlay" (click)="onButtonClick()" style="cursor: pointer;">
              <img src="assets/premium.png" alt="Contenido exclusivo para usuarios Premium" class="overlay-image">
            </div>
          </div>
      
          <div class="report-card">
            <div class="report-header">
              <span class="material-icons report-icon">account_balance_wallet</span>
              <h2>{{(usuariosDeudores / totalUsuarios) * 100 | number:'1.0-2'}}%</h2>
            </div>
            <p>Tasa de Deuda de Usuarios</p>
            <div class="progress-bar-container">
              <div class="progress-bar">
                <div class="progress" [style.width.%]="(usuariosDeudores / totalUsuarios) * 100"></div>
              </div>
            </div>
      
            <!-- Overlay para cuentas no Premium -->
            <div *ngIf="user.accountType !== 'PREMIUM'" class="overlay" (click)="onButtonClick()" style="cursor: pointer;">
              <img src="assets/premium.png" alt="Contenido exclusivo para usuarios Premium" class="overlay-image">
            </div>
          </div>
        </div>
      </div>
      
    </div>       
  </div>
</div>
